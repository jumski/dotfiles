#!/bin/bash

# Path to mode configuration file
MODE_FILE="$HOME/.config/window-focus-mode"

# Read mode from file, default to 'activities' if file doesn't exist or is empty
if [ -f "$MODE_FILE" ]; then
  MODE=$(cat "$MODE_FILE" | tr -d '[:space:]')
fi

# Default to 'activities' if MODE is empty
if [ -z "$MODE" ]; then
  MODE="activities"
fi

# Get the directory where this script is located
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
FOCUS_TOGGLER_DIR="$(dirname "$SCRIPT_DIR")/focus-toggler"

# Dispatch to the appropriate script based on mode
case "$MODE" in
  activities)
    exec "$FOCUS_TOGGLER_DIR/toggle_activities.sh"
    ;;
  windows)
    exec "$FOCUS_TOGGLER_DIR/toggle_windows.sh"
    ;;
  *)
    echo "Error: Unknown mode '$MODE'. Defaulting to 'activities'."
    exec "$FOCUS_TOGGLER_DIR/toggle_activities.sh"
    ;;
esac
